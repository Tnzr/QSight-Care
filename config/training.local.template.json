{
  "dataset_root": "/absolute/path/to/datasets/DiabeticRetinopathy/resized_train_cropped",
  "output_dir": "trained_model",
  "stages_config": null,
  "batch_size": 24,
  "train_ratio": 0.9,
  "num_workers": 4,
  "use_weighted_sampler": true,
  "weighted_sampler_replacement": false,
  "weighted_sampler_min_weight": 0.005,
  "weighted_sampler_max_weight": 0.25,
  "class_weight_exponent": 0.65,
  "seed": 42,
  "pretrained": true,
  "encoder_type": "resnet50",
  "device": "cuda:0",
  "grad_clip": 1.0,
  "mixed_precision": true,
  "enable_latency_tracking": true,
  "log_interval": 25,
  "quantum_enabled": true,
  "quantum_qubits": 4,
  "quantum_shots": 1024,
  "use_wandb": false,
  "wandb_project": "qsight-care",
  "wandb_entity": null,
  "wandb_run_name": null,
  "wandb_tags": [
    "local"
  ],
  "wandb_mode": "online",
  "checkpoint_dir": "trained_model/checkpoints",
  "multi_gpu": false,
  "device_ids": [0, 1],
  "collapse_detection_enabled": true,
  "collapse_threshold": 0.85,
  "collapse_patience": 2,
  "collapse_cooldown": 2,
  "collapse_reweight_factor": 0.35,
  "collapse_min_class_weight": 0.08,
  "collapse_log_distributions": true,
  "collapse_entropy_weight": 0.0,
  "collapse_entropy_target": 1.3,
  "collapse_distill_weight": 0.0,
  "collapse_distill_temperature": 2.0,
  "auto_tune_batch_size": false,
  "batch_tuner_min_batch_size": null,
  "batch_tuner_max_batch_size": null,
  "batch_tuner_growth_factor": 1.5,
  "batch_tuner_target_utilization": 0.9,
  "batch_tuner_max_latency_increase": 1.3,
  "batch_tuner_include_val": true,
  "batch_tuner_warmup_steps": 1,
  "quantization": {
    "enabled": true,
    "approach": "ptq_dynamic",
    "backend": "qnnpack",
    "calibration_batches": 32,
    "export_onnx_path": "trained_model/quantized/model.onnx",
    "onnx_opset": 18,
    "onnx_dynamic_axes": true,
    "onnx_input_shape": [1, 3, 224, 224]
  },
  "stages": [
    {
      "name": "classical",
      "num_epochs": 25,
      "learning_rate": 0.005,
      "patience": 3,
      "active_mask": [1, 1, 0],
      "grad_accum_steps": 1,
      "loss_weights": {
        "classical_a": 1.0,
        "classical_b": 1.0,
        "quantum": 0.0,
        "ensemble": 0.25
      }
    },
    {
      "name": "quantum",
      "num_epochs": 10,
      "learning_rate": 0.00008,
      "patience": 3,
      "active_mask": [0, 0, 1],
      "grad_accum_steps": 2,
      "force_data_parallel": false,
      "annealing_schedule": {
        "start_temp": 2.5,
        "end_temp": 0.6,
        "start_noise": 0.2,
        "end_noise": 0.0,
        "strategy": "cosine"
      }
    },
    {
      "name": "ensemble",
      "num_epochs": 12,
      "learning_rate": 0.001,
      "grad_accum_steps": 1,
      "loss_weights": {
        "ensemble": 1.0
      }
    }
  ]
}
